---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.






```{r}

###GETTING THE DATA
```
```{r}
data <- read.csv(file.choose(("Mall_Customers.csv")))
str(data)
```
```{r}
head(data)
```
```{r}
summary(data)
```
```{r}
a=table(data$Gender)
barplot(a,main="Using BarPlot to display Gender Comparision",
       ylab="Count",
       xlab="Gender",
       col=rainbow(2),
       legend=rownames(a))


hist(data$Age,
    col="green",
    main="Histogram to Show Count of Age Class",
    xlab="Age",
    ylab="Frequency",
    labels=TRUE)
```
```{r}
hist(data$Annual.Income..k..,
  col="#660033",
  main="Histogram for Annual Income",
  xlab="Annual Income Class",
  ylab="Frequency",
  labels=TRUE)

hist(data$Spending.Score..1.100.,
    main="HistoGram for Spending Score",
    xlab="Spending Score Class",
    ylab="Frequency",
    col="#6600cc",
    labels=TRUE)
```
``
```{r}
boxplot(data$Age,
       col="#ff0066",
       main="Boxplot for Descriptive Analysis of Age")
```
```{r}
plot(density(data$Annual.Income..k..),
    col="yellow",
    main="Density Plot for Annual Income",
    xlab="Annual Income Class",
    ylab="Density")
#polygon(density(data$Annual.Income..k..), col="#ccff66")
```
```{r}
library(purrr)
set.seed(123)
# function to calculate total intra-cluster sum of square 
iss <- function(k) {
  kmeans(data[,3:5],k,iter.max=100,nstart=100,algorithm="Lloyd" )$tot.withinss
}

k.values <- 1:10


iss_values <- map_dbl(k.values, iss)

plot(k.values, iss_values,
    type="b", pch = 19, frame = FALSE, 
    xlab="Number of clusters K",
    ylab="Total intra-clusters sum of squares")
```
```{r}
##K-MEANS CLUSTERING
```
```{r}
#STEP 1 - Determining the optimal no of clusters
##Here I'm using the gap statistics method.
library(cluster)

set.seed(125)
stat_gap <- clusGap(data[,3:5], FUN = kmeans, nstart = 25,
            K.max = 10, B = 50)
#plot(stat_gap)
#Dividing into 6 clusters
k6<-kmeans(data[,3:5],6,iter.max=100,nstart=50,algorithm="Lloyd")
k6

```
```{r}
clusplot(data, k6$cluster, color=TRUE, shade=TRUE, labels=0,lines=0, )

```
```{r}
pcclust=prcomp(data[,3:5],scale=FALSE) #principal component analysis
summary(pcclust)
pcclust$rotation[,1:2]
```
```{r}
library("ggplot2")
set.seed(1)
ggplot(data, aes(x =Annual.Income..k.., y = Spending.Score..1.100.)) + 
  geom_point(stat = "identity", aes(color = as.factor(k6$cluster))) +
  scale_color_discrete(name=" ",
              breaks=c("1", "2", "3", "4", "5","6"),
              labels=c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster 4", "Cluster 5","Cluster 6")) +
  ggtitle("Segments of Mall Customers", subtitle = "Using K-means Clustering")

```




